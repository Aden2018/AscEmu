# Copyright (C) 2014-2016 AscEmu Team <http://www.ascemu.org>

# set up our project name
project(world CXX)

include(Chat/CMakeLists.txt)
include(Chat/Commands/CMakeLists.txt)
include(Map/CMakeLists.txt)
include(Map/Area/CMakeLists.txt)
include(Packets/CMakeLists.txt)
include(Packets/Handlers/CMakeLists.txt)
include(Packets/Movement/CMakeLists.txt)
include(Server/CMakeLists.txt)
include(Server/Console/CMakeLists.txt)
include(Server/LogonCommClient/CMakeLists.txt)
include(Storage/CMakeLists.txt)
include(Storage/DBC/CMakeLists.txt)

set(sources
   ${SRC_CHAT_FILES}
   ${SRC_COMMAND_FILES}
   ${SRC_MAP_FILES}
   ${SRC_MAP_AREA_FILES}
   ${SRC_PACKET_FILES}
   ${SRC_PACKET_HANDLER_FILES}
   ${SRC_PACKET_MOVEMENT_FILES}
   ${SRC_SERVER_FILES}
   ${SRC_SERVER_CONSOLE_FILES}
   ${SRC_LOGON_COMMUNICATION_CLIENT_FILES}
   ${SRC_STORAGE_FILES}
   ${SRC_STORAGE_DBC_FILES}
   
   AchievementMgr.cpp 
   CollideInterface.cpp 
	DayWatcherThread.cpp 
	CommonScheduleThread.cpp 
	ArenaTeam.cpp 
	DatabaseCleaner.cpp 
	AddonMgr.cpp 
	AIInterface.cpp 
	AIEvents.cpp
	Arenas.cpp 
	AuctionHouse.cpp 
	AuctionMgr.cpp 
	Battleground.cpp
	BattlegroundMgr.cpp 
    CalendarMgr.cpp
	Channel.cpp 
    CObjectFactory.cpp
	Container.cpp 
	Corpse.cpp 
	Creature.cpp 
	Entities/Summons/Summon.cpp
	Entities/Summons/CompanionSummon.cpp
	Entities/Summons/GuardianSummon.cpp
	Entities/Summons/PossessedSummon.cpp
	Entities/Summons/TotemSummon.cpp
	Entities/Summons/WildSummon.cpp
	DynamicObject.cpp 
	EquipmentSetMgr.cpp
	EventableObject.cpp 
	EventMgr.cpp 
	Faction.cpp
    GameEvent.cpp
    GameEventMgr.cpp
	GameObject.cpp 
	CRitual.cpp
	Gossip.cpp
	Group.cpp 
	Guild.cpp 
	Item.cpp 
	ItemInterface.cpp 
    LfgGroupData.cpp
    LfgPlayerData.cpp
	LfgMgr.cpp 
	LootMgr.cpp 
	LocalizationMgr.cpp 
    MailMgr.cpp
   Main.cpp
   Movement/MovementCommon.cpp
   Movement/Spline/MovementSpline.cpp
   Movement/Spline/SplineFlags.cpp
   Movement/UnitMovementManager.cpp
	Object.cpp 
	ObjectMgr.cpp 
	Pet.cpp 
	Player.cpp
	PlayerCache.cpp
	PlayerPacketWrapper.cpp
	Quest.cpp 
    QuestLogEntry.cpp
	QuestMgr.cpp 
	ScriptMgr.cpp 
	SpeedDetector.cpp
   SpellManagement/SpellCustomizations.cpp
	SpellAuras.cpp 
	SpellTarget.cpp 
	Spell.cpp 
	StdAfx.cpp
	SummonHandler.cpp
	SpellEffects.cpp 
	SpellHandler.cpp 
	HackFixes.cpp 
	Stats.cpp 
	TaxiMgr.cpp 
	TransporterHandler.cpp 
	Unit.cpp 
	Vehicle.cpp 
	WeatherMgr.cpp 
	World.cpp 
	WorldCreator.cpp 
	WorldSession.cpp 
	WorldSocket.cpp 
	WorldStatesHandler.cpp
	WorldRunnable.cpp 
	WordFilter.cpp 
	Master.cpp 
	WUtil.cpp 
	SpellProc.cpp
   SpellProc_ClassScripts.cpp
	SpellProc_Items.cpp
	SpellMgr.cpp
   Spell_ClassScripts.cpp
	DeathKnight.cpp
)

if(WIN32)
   set(sources ${sources} resources.rc)
endif()

set(headers
	AchievementMgr.h
	AddonMgr.h
	AIInterface.h
	AIEvents.h
	Arenas.h
	ArenaTeam.h
	AuctionHouse.h
	AuctionMgr.h
	Battleground.h
	BattlegroundMgr.h
    CalendarMgr.h
	Channel.h
	ChannelMgr.h
    CObjectFactory.h
	CollideInterface.h
	CommonScheduleThread.h
	Entities/Summons/CompanionSummon.h
    Entities/Summons/SummonDefines.hpp
	Container.h
	Corpse.h
	Creature.h
    CreatureDefines.hpp
	DatabaseCleaner.h
	DayWatcherThread.h
	Definitions.h
	DynamicObject.h
	EquipmentSetMgr.h
	EventableObject.h
	EventMgr.h
	Faction.h
    GameEvent.h
    GameEventMgr.h
	GameObject.h
	CRitual.h
    Gossip/GossipDefines.hpp
	Gossip.h
	Group.h
	Entities/Summons/GuardianSummon.h
	Guild.h
	Item.h
	ItemInterface.h
	ItemPrototype.h
	IUpdatable.h
    Lfg.h
    LfgGroupData.h
    LfgPlayerData.h
	LfgMgr.h
	LocalizationMgr.h
	LootMgr.h
	MailMgr.h
	MainServerDefines.h
	Master.h
   Movement/MovementCommon.hpp
   Movement/UnitMovementManager.hpp
   Movement/Spline/MovementSpline.hpp
   Movement/Spline/MovementSplineDefines.hpp
   Movement/Spline/SplineFlags.hpp
	Object.h
	ObjectMgr.h
	Pet.h
	Player.h
   Player/PlayerClasses.hpp
    PlayerDefines.hpp
	PlayerCache.h
	Entities/Summons/PossessedSummon.h
	Quest.h
    QuestDefines.hpp
    QuestLogEntry.hpp
	QuestMgr.h
    RecastIncludes.hpp
	ScriptMgr.h
	ScriptSetup.h
	Skill.h
	SkillNameMgr.h
	SpeedDetector.h
   SpellManagement/SpellCustomizations.hpp
	Spell.h
	SpellAuras.h
	SpellFailure.h
	SpellMgr.h
	SpellNameHashes.h
	SpellProc.h
	SpellTarget.h
	Stats.h
	StdAfx.h
	Entities/Summons/Summon.h
	SummonHandler.h
	TaxiMgr.h
	Entities/Summons/TotemSummon.h
    Transports/TransportSpawn.hpp
	TransporterHandler.h
	Unit.h
    UnitDefines.hpp
	UpdateFields.h
	UpdateMask.h
	Vehicle.h
	WeatherMgr.h
	Entities/Summons/WildSummon.h
	WordFilter.h
	World.h
	WorldCreator.h
    WorldCreatorDefines.hpp
	WorldRunnable.h
	WorldSession.h
	WorldSocket.h
	WorldStatesHandler.h
	WorldStates.h
    WorldStrings.h
	WUtil.h
)

include_directories(
   ${OPENSSL_INCLUDE_DIR}
   ${PCRE_INCLUDE_DIR}
   ${CMAKE_SOURCE_DIR}/dep/recastnavigation/Detour/Include
   ${CMAKE_SOURCE_DIR}/dep/recastnavigation/Recast/Include
   ${CMAKE_SOURCE_DIR}/src/collision
   ${CMAKE_SOURCE_DIR}/src/collision/Management
   ${CMAKE_SOURCE_DIR}/src/collision/Maps
   ${CMAKE_SOURCE_DIR}/src/collision/Models
   ${CMAKE_SOURCE_DIR}/dep/g3dlite/include
   ${CMAKE_SOURCE_DIR}/src/shared
   ${CMAKE_CURRENT_SOURCE_DIR}
   ${ZLIB_INCLUDE_DIRS}
)

add_executable(${PROJECT_NAME} ${sources} ${headers})

if(USE_PCH AND PCHSupport_FOUND)
    ADD_NATIVE_PRECOMPILED_HEADER(${PROJECT_NAME} StdAfx.h ${CMAKE_CURRENT_SOURCE_DIR}/StdAfx.cpp)
endif()

set_target_properties(${PROJECT_NAME} PROPERTIES ENABLE_EXPORTS TRUE)
add_dependencies(${PROJECT_NAME} shared g3dlite collision Detour Recast)
configure_file(${CMAKE_CURRENT_SOURCE_DIR}/WorldConf.h.in ${CMAKE_CURRENT_SOURCE_DIR}/WorldConf.h)

target_link_libraries(${PROJECT_NAME} shared g3dlite collision Detour Recast ${PCRE_LIBRARIES})
install(TARGETS ${PROJECT_NAME} RUNTIME DESTINATION .)
